[tox]
envlist = {py36,py37,py38,py39}-{windows-32,windows-64,nix}, docs, flake8
skip_missing_interpreters = True

[testenv]
deps = -rtests/requirements.txt
commands = 
    python setup.py build_ext --inplace
    python -m pytest -vvv {posargs}
basepython =
    py36-nix: python3.6
    py37-nix: python3.7
    py38-nix: python3.8
    py39-nix: python3.9
    py36-windows-32: C:\\Python36\\python.exe
    py36-windows-64: C:\\Python36-x64\\python.exe
    py37-windows-32: C:\\Python37\\python.exe
    py37-windows-64: C:\\Python37-x64\\python.exe
    py38-windows-32: C:\\Python38\\python.exe
    py38-windows-64: C:\\Python38-x64\\python.exe
    py39-windows-32: C:\\Python39\\python.exe
    py39-windows-64: C:\\Python39-x64\\python.exe

[testenv:flake8]
basepython=python
commands = flake8 --ignore=W391 stl tests

[testenv:docs]
basepython=python
changedir=docs
commands=
    sphinx-build -b html -d {envtmpdir}/doctrees . {envtmpdir}/html
# sphinx-build -W -b html -d {envtmpdir}/doctrees . {envtmpdir}/html

[testenv:py36-nix]
# one optional test has PyQt5 dep, only test that once
deps = 
    -rtests/requirements.txt
    PyQt5
